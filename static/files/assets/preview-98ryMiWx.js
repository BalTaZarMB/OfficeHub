const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-0NgBIML-.js","assets/index-CP9bbISh.js","assets/vue-CE51Rq-N.js","assets/arco-CSlgBs8T.js","assets/index-DgS3TR8z.css","assets/index-BHrxhp-L.css","assets/index-BVdvKeVh.css","assets/index-Mb2FwH0E.css","assets/index-6rnfXikd.css","assets/index-8er2yjEK.css","assets/index-CD0PvSSd.css","assets/index-DMsf4HX_.css","assets/index-AiJAGXR2.css","assets/index-CmHRKhBm.css","assets/index-BdBJDoqm.js","assets/dom-w3hEyMar.js","assets/index-DLevhAQE.js","assets/dataModel-BAnfpXEG.js","assets/editor-erg3WYaJ.js","assets/file-5T113FlP.js","assets/dom2imgBlob-9Y9ueTAB.js","assets/mitt-DRzrVJO_.js","assets/regexp-get-flags-C7Uvd9jb.js","assets/index.esm-CMCG6-Sp.js","assets/index-DcbzwQnB.css","assets/index-BjBdBAHx.css","assets/index-CrADudCy.js","assets/index.vue_vue_type_script_setup_true_lang-B-7UBCTw.js","assets/index-CVht5qs2.js","assets/index-BdsTH0QC.css","assets/entry-Bl8EDNG_.js","assets/index-C9q-mfps.css","assets/index-DJ09e1LN.css","assets/tool-Bo2ff5vQ.js","assets/tool-DKhUqd2f.css","assets/index-CZF-QX0n.css","assets/index-saoVbYNb.css"])))=>i.map(i=>d[i]);
import{_ as e}from"./index-DTTWDj9t.js";import{i as a,r as t}from"./paging-DIzHhPFZ.js";import{u as i,g as s,d as o,_ as n,b as d}from"./index-CP9bbISh.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import{g as l}from"./doc-tool-3Vubxboe.js";import{c as r,I as p}from"./index.module-j6bqOxnK.js";import{a as u}from"./dataModel-BAnfpXEG.js";import{H as m,k as c,B as v,l as _}from"./arco-CSlgBs8T.js";import{d as g,r as f,a as j,j as x,n as h,u as y,l as b,m as C,$ as I,s as k,y as w,x as E,q as O,a3 as H}from"./vue-CE51Rq-N.js";import{c as R}from"./index.module-Dn-jvZ8J.js";import"./index.vue_vue_type_script_setup_true_lang-B-7UBCTw.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./index-CVht5qs2.js";import"./entry-Bl8EDNG_.js";import"./index.esm-CMCG6-Sp.js";import"./index.vue_vue_type_script_setup_true_lang-BjN5Q8E7.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./editor-erg3WYaJ.js";import"./dom-w3hEyMar.js";var D="/files/";const P=d(g({__name:"Preview",emits:["handleChangeData"],setup(e,{expose:a,emit:t}){const d=H((()=>n((()=>import("./index-0NgBIML-.js")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13])))),g=H((()=>n((()=>import("./index-BdBJDoqm.js").then((e=>e.bx))),__vite__mapDeps([14,1,2,3,4,15,16,17,18,19,20,21,22,23,24,6,7,25,11])))),R=H((()=>n((()=>import("./index-CrADudCy.js")),__vite__mapDeps([26,1,2,3,4,27,28,29,30,23,31,6,8,9,11,25,12,32,13,16,33,34,35,36])))),P=i(),V=f(!1),L=f(!1),W=f(),B=f([]),A=f(!1),T=f(!0),F=f([]),M=f([]),$=f(""),q=j({a:111}),G=f(),N=f(),Q=j({page:1,total:0}),z=f(),J=t,K=e=>{G.value=e,Object.assign(q,{}),F.value=[],Y()},S=async(e,a)=>{try{const e=l(N.value);M.value=e}catch(t){}L.value=!0,V.value=!0},U=e=>{Object.assign(q,e)},X=()=>{},Y=async(e=1,a)=>{var t,i,n,d,l,r;const p={tid:null==(t=s())?void 0:t.tid,uid:(null==(i=s())?void 0:i.uid)||P.userId},m=await u(p),c={...m.data},v=[],_=c.schema;let g;_.forEach(((e,a)=>{"pageLine"===e.type&&v.push(a)})),v.length&&(g=1==e?_.slice(0,v[0]):_.slice(v[e-2]+1,v[e-1])),c.schema=g||_;const f={...m,data:{...c},total:v.length,page:e};v.length?(Q.page=e,Q.total=v.length):(Q.page=1,Q.total=0),m.status&&"1"===m.status&&(null==(n=s())?void 0:n.uid)&&(null==(d=s())?void 0:d.uid)!==P.userId&&(location.href=`${D}forbiddenPage`),T.value=!1,$.value=m.title||(null==(l=s())?void 0:l.title)||"",N.value=m.data.schema||[],J("handleChangeData",{title:m.title,vt:m.vt,hasFav:m.hasFav||!1,tid:m.tid||(null==(r=s())?void 0:r.tid)}),((e,a)=>{var t,i;const s=a?[...e.schema]:[...B.value,...e.schema];G.value.blocks.render({blocks:s}),B.value=s,F.value=(null==(t=e.config)?void 0:t.bar)||[],Object.assign(q,(null==(i=e.config)?void 0:i.waterConfig)||{})})(f.data,e<2),o({title:m.title,desc:""})},Z=()=>{Y(Q.page+1)};return a({editorRef:G}),(e,a)=>{const t=m,i=p,s=c,o=v,n=_;return x(),h("div",{class:k(I(r).editWrap)},[y(t,{"offset-top":80,style:{position:"absolute",left:"20px"}},{default:b((()=>[C("div",{class:k(I(r).leftBar)},[y(I(R),{dir:I(M)},null,8,["dir"])],2)])),_:1}),C("div",{class:k(I(r).previewWrap),ref_key:"docRef",ref:W},[y(I(d),{visible:I(A),value:I(q),onHandleWaterChange:U,onHandleWaterModalClose:X},{default:b((()=>[y(n,{id:"pageContent",style:{margin:"0 20px",position:"relative",overflow:"hidden",padding:"20px","border-radius":"6px","min-height":"700px"},class:"colorBgContainer pubCol"},{default:b((()=>[I(T)?(x(),h("div",{key:0,class:k(I(r).isLoadingBox)},[y(s,{loading:I(T),tip:"文档加载中..."},{icon:b((()=>[y(i)])),_:1},8,["loading"])],2)):(x(),h("div",{key:1,class:k(I(r).titleIpt)},w(I($)),3)),y(I(g),{minHeight:60,readOnly:!0,onGetEditorInstance:K,onHandleEditorChange:S}),I(Q).total&&I(Q).total>=I(Q).page?(x(),h("div",{key:2,ref_key:"pagationRef",ref:z,style:{"text-align":"center"}},[y(o,{type:"primary",onClick:Z},{default:b((()=>[E("当前为第"+w(I(Q).page)+"页，共"+w(I(Q).total+1)+"页",1)])),_:1})],512)):O("",!0)])),_:1})])),_:1},8,["visible","value"])],2)],2)}}}),[["__scopeId","data-v-18584429"]]),V=d(g({__name:"preview",setup(i){const s=f(),o=j({isPreview:!0}),n=e=>{"2"===e?a():t()},d=e=>{Object.assign(o,e)};return(a,t)=>{const i=e;return x(),h("div",{class:k(I(R).homeView)},[y(i,{onHandleViewChange:n,dataInfo:I(o)},null,8,["dataInfo"]),y(P,{onHandleChangeData:d,ref_key:"editorComRef",ref:s},null,512)],2)}}}),[["__scopeId","data-v-971fad88"]]);export{V as default};
