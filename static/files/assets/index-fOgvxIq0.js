import{_ as e}from"./index-tS2fN0Zd.js";import{_ as t}from"./index.vue_vue_type_script_setup_true_lang-CQpENLI4.js";import"./index-CP9bbISh.js";/* empty css              */import"./index.vue_vue_type_script_setup_true_lang-B-7UBCTw.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{a,b as l}from"./entry-Bl8EDNG_.js";import{M as i,I as s,F as r,O as o,m as n,b as d,j as u}from"./arco-CSlgBs8T.js";import{d as m,r as p,a as c,j as f,n as _,u as g,$ as v,l as x,F as j,O as h,k as b,x as y,y as U,W as w}from"./vue-CE51Rq-N.js";/* empty css              *//* empty css              */import"./index-CVht5qs2.js";/* empty css              */import"./index.vue_vue_type_script_setup_true_lang-BjN5Q8E7.js";import"./index.esm-CMCG6-Sp.js";import"./mitt-DRzrVJO_.js";const C={apiConfig:{apiUrl:"/doc/resource",params:{cate:localStorage.getItem("resourceCateVal")||"",title:""}},pagination:!0,size:"large",columns:[{title:"名称",dataIndex:"title",align:"left",width:350},{title:"上传时间",dataIndex:"vt",align:"left",type:"time",ellipsis:!0,tooltip:!0},{title:"资源地址",dataIndex:"url",align:"left",type:"open",ellipsis:!0,tooltip:!0}],operation:[{type:"delete",btnName:"删除"}],data:[]},V=m({__name:"index",emits:["handleChange"],setup(m,{expose:V,emit:R}){const k=p(),I=p(),q=p(!1),F=p([]),N=c({cate:"",title:"",url:""}),O={title:[{required:!0,message:"请输入"}],cate:[{required:!0,message:"请选择"}],url:[{required:!0,message:"请上传",trigger:"change"}]},S=R,W=()=>{I.value.resetFields()},z=async()=>{var e;return!(await(null==(e=I.value)?void 0:e.validate()))&&(await a(N),C.apiConfig.params.cate=N.cate,S("handleChange",N.cate),i.success("添加成功"),k.value.setRefresh(),!0)},M=async()=>{const e=await l();F.value=e.map((e=>{if("1"===e.role)return e})).filter((e=>void 0!==e))};return V({tableRef:k,handleShow:()=>{q.value=!0,M()},schemaChange:e=>{C.apiConfig.params.cate=e}}),(a,l)=>{const i=t,m=s,p=r,c=o,V=n,R=e,S=d,M=u;return f(),_("div",null,[g(i,{ref_key:"tableRef",ref:k,schema:v(C)},null,8,["schema"]),g(M,{visible:v(q),"onUpdate:visible":l[3]||(l[3]=e=>w(q)?q.value=e:null),title:"资源","title-align":"start","unmount-on-close":!0,"on-before-ok":z,onClose:W},{default:x((()=>[g(S,{ref_key:"formRef",ref:I,model:v(N),rules:O},{default:x((()=>[g(p,{field:"title",label:"名称","show-colon":""},{default:x((()=>[g(m,{modelValue:v(N).title,"onUpdate:modelValue":l[0]||(l[0]=e=>v(N).title=e),placeholder:"请输入名称"},null,8,["modelValue"])])),_:1}),g(p,{field:"cate",label:"分类","show-colon":""},{default:x((()=>[g(V,{class:"borderRadius",modelValue:v(N).cate,"onUpdate:modelValue":l[1]||(l[1]=e=>v(N).cate=e)},{default:x((()=>[(f(!0),_(j,null,h(v(F),(e=>(f(),b(c,{key:e.tid,value:e.tid},{default:x((()=>[y(U(e.title),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])),_:1}),g(p,{field:"url",label:"资源","show-colon":""},{default:x((()=>[g(R,{imgUrl:v(N).url,"onUpdate:imgUrl":l[2]||(l[2]=e=>v(N).url=e),parentRef:v(I),"validate-str":"url"},null,8,["imgUrl","parentRef"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible"])])}}});export{V as default};
