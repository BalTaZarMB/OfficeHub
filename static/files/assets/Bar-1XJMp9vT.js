import e from"./index-Cs4RF5if.js";import{_ as t}from"./index.vue_vue_type_script_setup_true_lang-BjN5Q8E7.js";import{f as a,j as i}from"./index-CP9bbISh.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{f as o}from"./index.esm-CMCG6-Sp.js";import{d as s,e as l,f as r}from"./dataModel-BAnfpXEG.js";import{I as n,a as p}from"./index-C17TI_eh.js";import{_ as c,g as d,i as u,J as m,I as v,B as _,T as g,a as x,K as y,N as f,L as k,h,n as j,G as b}from"./arco-CSlgBs8T.js";import{d as w,c as C,j as B,n as L,s as z,p as S,m as V,r as N,a as I,o as T,F as $,O as q,$ as H,u as O,l as P,k as R,N as U,W,q as D,x as F,y as G}from"./vue-CE51Rq-N.js";/* empty css              */import"./editor-erg3WYaJ.js";const J=w({name:"IconSend",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:t}){const a=d("icon");return{cls:C((()=>[a,`${a}-send`,{[`${a}-spin`]:e.spin}])),innerStyle:C((()=>{const t={};return e.size&&(t.fontSize=u(e.size)?`${e.size}px`:e.size),e.rotate&&(t.transform=`rotate(${e.rotate}deg)`),t})),onClick:e=>{t("click",e)}}}}),K=["stroke-width","stroke-linecap","stroke-linejoin"],M=[V("path",{d:"m14 24-7-5V7l34 17L7 41V29l7-5Zm0 0h25","stroke-miterlimit":"3.864"},null,-1)];var Q=c(J,[["render",function(e,t,a,i,o,s){return B(),L("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:z(e.cls),style:S(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:t[0]||(t[0]=(...t)=>e.onClick&&e.onClick(...t))},M,14,K)}]]);const Z=Object.assign(Q,{install:(e,t)=>{var a;const i=null!=(a=null==t?void 0:t.iconPrefix)?a:"";e.component(i+Q.name,Q)}}),A={controlBox:"_controlBox_8igos_1",item:"_item_8igos_1",text:"_text_8igos_13",admiration:"_admiration_8igos_16",barrage:"_barrage_8igos_25",moveLeft:"_moveLeft_8igos_1",barrageBox:"_barrageBox_8igos_37",barrageItem:"_barrageItem_8igos_44",moveRightToLeft:"_moveRightToLeft_8igos_1",scrollbarHei:"_scrollbarHei_8igos_59"},E=["onClick"],X={style:{position:"relative"}},Y={key:2},ee={style:{"max-width":"240px"},class:"ellipsis"},te=["src"],ae={class:"ellipsis"},ie={style:{"max-width":"300px"},class:"ellipsis"},oe=w({__name:"Bar",props:{list:{},user:{},redirectUrl:{},params:{}},emits:["handleBarClick"],setup(c,{expose:d,emit:u}){const w=N(!1),C={like:{icon:n,text:"喜欢",html:""},review:{icon:p,text:"评论",html:""}},S=u,J=N([]),K=N([]),M=N(!1),Q=N(!1),oe=N(""),se=N(""),le=I({pageSize:6,onchange:(e,t)=>{},total:0}),re=N(!0),ne=e=>{e.stopPropagation(),M.value=!1},pe=()=>{se.value=""},ce=async()=>{if(se.value)return await s(se.value),se.value="",void de()},de=async()=>{w.value=!0;const e=await l();w.value=!1;const{list:t,total:i}=e;le.total=i,J.value=t.map(((e,t)=>({...e,avatar:e.avatar||a})))},ue=()=>{if(oe.value){const e=Date.now();K.value.push({id:e,text:oe.value,top:i([0,10,30,50,80,100])}),r({id:e,val:oe.value}),oe.value=""}};return T((()=>{})),d({fetchReviewList:de}),(a,i)=>{const s=t,l=m,r=v,n=Z,p=_,c=g,d=x,u=y,N=f,I=k,T=h,me=j,ve=e,_e=b;return B(),L("div",{class:z(H(A).controlBox)},[(B(!0),L($,null,q(a.list,(e=>(B(),L("span",{class:z([H(A).item,"colorTextBase","colorBgContainer"]),key:e.type,onClick:t=>(e=>{if("review"===e.type)return M.value=!0,void de();S("handleBarClick",e.type)})(e)},[O(c,{position:"barrage"===e.type?"bottom":"left",content:C[e.type].text},{default:P((()=>{return[V("div",X,[O(l,{count:(t=e,"like"===t.type?null==(a=t.config)?void 0:a.flovers:"review"===t.type?J.value.length:"barrage"===t.type?K.value.length:0),offset:[10,-10],overflowCount:99,"dot-style":{backgroundColor:"var(--color-btn)"}},{default:P((()=>[V("span",{class:z(H(A).icon)},[""!=C[e.type].icon?(B(),R(U(C[e.type].icon),{key:0})):(B(),R(s,{key:1,icon:C[e.type].html},null,8,["icon"]))],2)])),_:2},1032,["count"]),H(Q)&&"barrage"===e.type?(B(),L("div",{key:0,class:z([H(A).barrage,"colorBgContainer2"]),onClick:i[1]||(i[1]=e=>e.stopPropagation())},[H(Q)?(B(),R(r,{key:0,modelValue:H(oe),"onUpdate:modelValue":i[0]||(i[0]=e=>W(oe)?oe.value=e:null),placeholder:"温柔的发送弹幕~"},null,8,["modelValue"])):D("",!0),H(Q)?(B(),R(p,{key:1,type:"primary"},{icon:P((()=>[O(n,{onClick:ue})])),_:1})):D("",!0),H(Q)?D("",!0):(B(),L("div",Y,[i[4]||(i[4]=F(" 发送弹幕前请先登录， ")),O(p,{type:"primary"},{default:P((()=>i[3]||(i[3]=[F("立即登录")]))),_:1})]))],2)):D("",!0)])];var t,a})),_:2},1032,["position","content"])],10,E)))),128)),O(_e,{visible:H(M),width:380,title:"评论列表",footer:!1,onCancel:ne,onBeforeOpen:pe},{default:P((()=>[H(re)?(B(),R(me,{key:0,style:{width:"330px"},class:z(H(A).scrollbarHei)},{default:P((()=>[V("div",null,[V("div",null,[O(d,{modelValue:H(se),"onUpdate:modelValue":i[2]||(i[2]=e=>W(se)?se.value=e:null),style:{height:"120px",resize:"none"},placeholder:"热心评论","max-length":100,"allow-clear":"","show-word-limit":""},null,8,["modelValue"]),O(p,{type:"primary",style:{"margin-top":"16px","border-radius":"4px"},size:"large",onClick:ce},{default:P((()=>i[5]||(i[5]=[F("发布")]))),_:1})]),i[6]||(i[6]=V("h3",null,"热门评论",-1)),O(T,{loading:H(w),"pagination-props":H(le),data:H(J)},{item:P((({item:e,index:t})=>[(B(),R(I,{"action-layout":"vertical",key:t},{actions:P((()=>[O(c,{content:e.text},{default:P((()=>[V("div",ie,G(e.text),1)])),_:2},1032,["content"])])),default:P((()=>[O(N,null,{title:P((()=>[O(c,{content:e.name},{default:P((()=>[V("div",ee,G(e.name),1)])),_:2},1032,["content"])])),avatar:P((()=>[O(u,{shape:"square"},{default:P((()=>[V("img",{alt:"avatar",src:e.avatar},null,8,te)])),_:2},1024)])),description:P((()=>[V("div",ae,G(H(o)(e.ct)),1)])),_:2},1024)])),_:2},1024))])),_:1},8,["loading","pagination-props","data"])])])),_:1},8,["class"])):(B(),R(ve,{key:1,text:"您还未登录，登录后即可发布评论",backText:"登录",showBack:""}))])),_:1},8,["visible"])],2)}}});export{oe as default};
